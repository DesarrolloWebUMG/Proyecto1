<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<link rel="stylesheet"  href="Estilos.css">
	<link rel="stylesheet"  href="Fonts.css">
	<link rel="stylesheet"  href="EstiloP.css">
	<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
	<title>PRODUCTOS</title>
<script src="jquery-3.3.1.js"></script>
<script>
      
      //aquí va el script para la BBDD de Web SQL

      var myDBInstance = openDatabase('TiendaJuegos', '1.0', 'Base de Datos para la compra de videojuegos', 2 * 1024 * 1024);

      if (!myDBInstance) {
            alert('La BBDD no fue creada correctamente');
      }
      else {
           var version = myDBInstance.version;

           myDBInstance.transaction(function (tran) {
                tran.executeSql('CREATE TABLE IF NOT EXISTS CarritoCompras (id unique, Nombre, Precio, Cantidad)');
                tran.executeSql('insert into CarritoCompras (id, Nombre, Precio, Cantidad) values (1, "Splatoon 2",699, 0)');
                tran.executeSql('insert into CarritoCompras (id, Nombre, Precio, Cantidad) values (2, "Mario Odyssey",699, 0)');
                tran.executeSql('insert into CarritoCompras (id, Nombre, Precio, Cantidad) values (3, "Zelda Breath of the Wild",699, 0)');
                tran.executeSql('insert into CarritoCompras (id, Nombre, Precio, Cantidad) values (4, "Super Smash Bros Ultimate",699, 0)');
                tran.executeSql('insert into CarritoCompras (id, Nombre, Precio, Cantidad) values (5, "Dragon Ball Xenoverse 2",699, 0)');
                tran.executeSql('insert into CarritoCompras (id, Nombre, Precio, Cantidad) values (6, "Pokemon Lets Go Pikachu",699, 0)');
            });
            //Código que se usó de prueba para mostrar toda la tabla en pantalla
            /*myDBInstance.transaction(function (tran) {
                var html = '<table><thead><th>ID Juego </th><th>Nombre del Juego </th><th>Precio </th><th>Cantidad </th></thead><tbody>';
                tran.executeSql('SELECT * FROM CarritoCompras', [], function (tran, data) {
                    for (i = 0; i < data.rows.length; i++) {
                        html += '<tr><td>' + data.rows[i].id + '</td><td>' + data.rows[i].Nombre + '</td><td>' + data.rows[i].Precio + '</td><td>'+ data.rows[i].Cantidad + '</td></tr>';
                    };
                    html += '</tbody></table>';
                    $('#myTab').html(html);
                });
            });*/
      }

      //draggable = "true" --> Elemento pueda moverse
      //ondrastar --> llama a la funcion drop(event)
      //ondragover --> llama a la funcion allowDrop(event)
      function drag(ev) {
      //establece el tipo de dato y valor del elemento capturado, en este caso el valor del atributo id
         ev.dataTransfer.setData("text", ev.target.id); 
         ev.effectAllowed = "copyMove";
      }

      function allowDrop(ev) {
          ev.preventDefault(); //Evitar la manipulación del navegador de los datos.
      }

      function drop(ev) {
         ev.preventDefault();
         var data = ev.dataTransfer.getData("text");
         
         if (data==1){   
            myDBInstance.transaction(function (tran) {
                  tran.executeSql('update CarritoCompras set Nombre = "Splatoon 2", Precio = 699, Cantidad = Cantidad+1 where id = 1'); 
               });
         }else if (data==2){
            myDBInstance.transaction(function (tran) {
                  tran.executeSql('update CarritoCompras set Nombre = "Super Mario Odyssey", Precio = 699, Cantidad = Cantidad+1 where id = 2'); 
               });
         }else if (data==3){
            myDBInstance.transaction(function (tran) {
                  tran.executeSql('update CarritoCompras set Nombre = "Zelda Breath of the Wild", Precio = 699, Cantidad = Cantidad+1 where id = 3'); 
               });
         }else if (data==4){
            myDBInstance.transaction(function (tran) {
                  tran.executeSql('update CarritoCompras set Nombre = "Super Smash Bros Ultimate", Precio = 699, Cantidad = Cantidad+1 where id = 4'); 
               });
         }else if (data==5){
            myDBInstance.transaction(function (tran) {
                  tran.executeSql('update CarritoCompras set Nombre = "Dragon Ball Xenoverse 2", Precio = 699, Cantidad = Cantidad+1 where id = 5'); 
               });
         }else if (data==6) {
            myDBInstance.transaction(function (tran) {
                  tran.executeSql('update CarritoCompras set Nombre = "Pokemon Lets Go Pikachu", Precio = 699, Cantidad = Cantidad+1 where id = 6'); 
               });
         }
         alert('Artículo agregado al carrito de compras');
      }
            
   </script>

</head>
<body>
	<header>
		<div class="Menu_bar">
			<a href="#" class="bt-menu"><span class="icon-menu"></span>Menu</a>
		</div>
		<nav>
			<ul>
				<li><a href="index.html"><span class="icon-home"></span>Inicio</a></li>
				<li><a class="active" href="Productos.html"><span class="icon-price-tags"></span>Productos</a></li>
				<li><a href="Compra.html"><span class="icon-cart"></span>Compra</a></li>
				<li><a href="#"><span class="icon-users"></span>Contactos</a></li>
			</ul>
		</nav>
	</header>
	<article style="padding-bottom:2000px"> 

			<section id="icono1">
				<img src="Producto/icono1.jpg" id="icono1">	
			</section>
         <!--para hacer que un elemento sea arrastrable draggable="true" -->

			<figure class="responsive">
            <img name="100" id ="1" class="juegos" src="Producto/descarga.jpg" alt="Splatoon 2" draggable="true" 
            ondragstart="drag(event)">
            <figcaption>Nintendo Switch Splatoon 2</figcaption>
            <figcaption>Q.699.00</figcaption>
         </figure>
   
         <figure class="responsive">
          <img  name="2" class="juegos" id ="2" src="Producto/descarga1.jpg" alt="Super Mario Odyssey" draggable="true"     ondragstart="drag(event)" >
            <figcaption>Nintendo Switch Super Mario Odyssey</figcaption>
            <figcaption>Q.699.00</figcaption>
         </figure>

         <figure class="responsive">
               <img  name="3" class="juegos" id ="3" src="Producto/descarga2.jpg" alt="Zelda Breath of the Wild" draggable="true"    ondragstart="drag(event)">
                  <figcaption>Nintendo Switch Zelda Breath of Wild</figcaption>
                  <figcaption>Q.699.00</figcaption>
         </figure>

			<figure class="responsive">
      			<img  id ="4" src="Producto/descarga3.jpg" alt="Super Smash Bros Ultimate" draggable="true"    ondragstart="drag(event)">
   				 <figcaption>Nintendo Switch Super Smash Bros Ultimate</figcaption>
   				 <figcaption>Q.699.00</figcaption>
   			 </figure>

			<figure class="responsive">
      			<img id ="5" src="Producto/descarga4.jpg" alt="Dragon Ball Xenoverse 2" draggable="true"    ondragstart="drag(event)">
   				 <figcaption>Nintendo Switch Dragon Ball Xenoverse 2</figcaption>
   				 <figcaption>Q.699.00</figcaption>
   			 </figure>

   			 <figure class="responsive">
      			<img id ="6" src="Producto/descarga5.jpg" alt="Pokemon Lets Go Pikachu" draggable="true"    ondragstart="drag(event)">
   				 <figcaption>Nintendo Switch Pokemon Let's Go Pikachu</figcaption>
   				 <figcaption>Q.629.00</figcaption>
   			 </figure>
		
	</article>
	<nav id="carrito" ondrop="drop(event)" ondragover="allowDrop(event)">
      <figure>
		<img src="compra.png"  id="compra">
      </figure>
	</nav>
	<script src="Menu.js"></script>
</body>
</html>